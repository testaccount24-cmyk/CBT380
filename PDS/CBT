PROC 1 FILE TO(0) ONLY DOC M() ART
/* DOCUMENTATION FOR CBT AND NASPA -- IN "THE REXX MACROS TOOLBOX" -- SOP #6260*
/* PROGRAMS, CLISTS, DOCUMENTATION, ETC. FROM PROFESSIONAL PROGRAMMERS*/
/*
/* COMPANION CLIST IS  NASPA -- SAME TECHNIQUES USED AS IN CBT */
/*  --------- EXAMPLES ------------------. */
/*   ==> TSO CBT DOC
/*   ==> TSO CBT 50
/*   ==> TSO CBT 50 M(%OC*)
/*   ==> TSO CBT 50 TO(55)
/*  --------- USEFUL TECHNIQUES ---------. */
/*   ==> TSO CBT DOC
/*   ==> X ALL;FIND SMF WORD ALL
/*   ==> APPEND DOC    -- IDENTIFY WITH CC-CC RANGE
/*   ==> TSO CBT 97    -- OR  TSO CBT 97 M($DOC)
/*   ==> APPEND DOC    -- IDENTIFY WITH CC-CC RANGE
/*   ==> $EDIT USERID.CUTDSN.LIST
/*   ==> @PRINT DOWN8
/*
CONTROL NOFLUSH NOMSG
/* DOCUMENTATION FOR CBT AND NASPA -- IN "THE REXX MACROS TOOLBOX" -- SOP #6260*
/* PROGRAMS, CLISTS, DOCUMENTATION, ETC. FROM PROFESSIONAL PROGRAMMERS*/
SET LP = &STR((
SET RP = &STR())
IF &STR(&M.) ^= &STR() THEN DO
  SET M = &STR(&M.)
  SET M = &STR(&LP.&STR(&M.)&RP.)
   SET MULTIMEM = &SYSINDEX(&STR(*),&STR(&MEMBER.))
   IF &MULTIMEM = 0 THEN -
      SET MULTIMEM = &SYSINDEX(&STR(%),&STR(&MEMBER.))
  SET ONLY = ONLY
END
ELSE SET M = &STR()
IF DOC = &DOC | DOC = &SYSCAPS(&FILE.) THEN DO
  ISPEXEC EDIT DATASET('TECH.CBT.FILE001.DATA')
  EXIT CODE(0)
END
IF ART = &ART | ART = &SYSCAPS(&FILE.) THEN DO
  WRITE ART OPTION APPLIES TO NASPA ONLY, NOT FOR CBT
  EXIT CODE(4)
  ISPEXEC EDIT DATASET('TECH.CBT.ARTICLES')
  EXIT CODE(0)
END
IF &TO. = 0 THEN SET TO = &FILE.
SET TO = &TO.
SET FILE = 1000 + &FILE.
SET MAX = 0
BACK: -
SET MAX = &MAX. + 1
IF &MAX. = 5  THEN DO
  SET &ZEDSMSG = &STR(CBT &SUBSTR(2:4,&FILE.)
  SET &ZEDLMSG = &STR(===> TSO &ZEDSMSG   -- TO CONTINUE WHERE LEFT OFF)
  ISPEXEC     SETMSG MSG(ISRZ000)
  EXIT CODE(0)
END
SET FILE = &SUBSTR(2:4,&FILE.)
IF &EVAL(&FILE.) > 900 THEN EXIT CODE(8)
IF MULTIMEM = 0 +
   THEN SET DSN = 'TECH.CBT.FILE&FILE..PDS&STR(&M.)'
   ELSE SET DSN = 'TECH.CBT.FILE&FILE..PDS'
SET XX = &SYSDSN(&DSN.)
IF &XX = OK THEN DO
 SET DSN = 'TECH.CBT.FILE&FILE..PDS&STR(&M.)'
 ISPEXEC EDIT DATASET(&DSN.)
END
ELSE DO
   SET XX = &SYSDSN('TECH.CBT.FILE&FILE..DATA')
   IF &XX = OK THEN ISPEXEC EDIT DATASET('TECH.CBT.FILE&FILE..DATA')
END
IF ONLY = &ONLY THEN EXIT CODE(0)
IF &EVAL(&TO.) NE 0 THEN -
  IF &EVAL(&FILE.) GE &EVAL(&TO.) THEN EXIT CODE(0)
SET FILE = 1001 + &FILE.
GOTO BACK
